# 🎄 미션 - 크리스마스 프로모션

## 📌 기능 구현 목록

1. 이벤트 진행을 위한 Controller인 *ChristmasController.class* 을 생성한다.
2. 이벤트를 시작한다.
    1. 12월 중 식당 예상 방문 날짜를 입력한다. (날짜는 숫자만 입력받는다.)
    2. 주문할 메뉴의 이름과 개수를 입력한다.(단일 메뉴: `이름-개수`, 복수 메뉴:`이름-개수,이름-개수`)
       1. 음료만 주문 시, 주문할 수 없다.
       2. 메뉴는 최대 20개까지만 주문이 가능하다. (메뉴의 개수 총합 기준)
    3. 주문 메뉴 리스트를 출력한다. (메뉴이름과 갯수는 공백으로 구분한다.)
    4. 할인 전 총주문 금액을 출력한다. (단위는 `원`단위로, 숫자 3자리 마다 쉼표`,`로 구분한다.)
   #### ※ 총주문 금액 10,000원 이상부터 이벤트가 적용된다.
    5. 증정 메뉴를 출력한다.
        1. 증정 메뉴는 `증정 이벤트`를 반영한다.
            - 할인 전 총주문 금액이 12만 원 이상일 때, **샴페인 1개** 증정한다.
            - 샴페인의 가격은 메뉴표를 참고하여 25,000원으로 책정한다.
            - 증정 메뉴가 없을 경우 `없음`으로 출력한다.
    6. 혜택 내역을 출력한다.
       - 혜택 내역이 없을 경우 `없음`으로 출력한다.
       1. `혜택명: 할인금액`을 출력한다. (크리스마스 디데이 할인: -1,200원)
       2. 혜택 내역은 `12월 이벤트 계획`를 반영한다.
          - 크리스마스 디데이 할인
            - 이벤트 기간: `2023.12.1 ~ 2023.12.25`
              **1,000**원으로 시작하여 크리스마스가 다가올수록 날마다 할인 금액이 100원씩 증가
          - 평일 할인(일요일~목요일)
            - 평일에는 **디저트 메뉴**를 메뉴 1개당 2,023원 할인
          - 주말 할인(금요일, 토요일)
            - 주말에는 **메인 메뉴**를 메뉴 1개당 2,023원 할인
          - 특별 할인
            - 이벤트 달력에 **별**이 있으면 총주문 금액에서 1,000원 할인
            - 별이 있는 날짜는 매주 일요일 (*3, 10, 17, 24, 31*)과 크리스마스(*25*)이다.
          - 증정 이벤트
            - 할인 전 총주문 금액이 12만 원 이상일 때, 샴페인 1개 증정
       3. 이벤트 기간: `크리스마스 디데이 할인`을 제외한 다른 이벤트는 `2023.12.1 ~ 2023.12.31` 동안 적용
    7. 총혜택 금액을 출력한다.(단위는 `원`단위로, 숫자 3자리 마다 쉼표`,`로 구분한다.)
       - 총혜택 금액이 0원일 경우 `0원`으로 출력한다.
       1. 총혜택 금액 = 할인 금액의 합계 + 증정 메뉴의 가격
    8. 할인 후 예상 결제 금액을 출력한다. 
       1. 할인 후 예상 결제 금액 = 할인 전 총주문 금액 - 할인 금액
    9. 12월 이벤트 배지를 출력한다.
       - 이벤트 배지가 부여되지 않는 경우, `없음`으로 출력한다.
       - 5천 원 이상: 별
       - 1만 원 이상: 트리
       - 2만 원 이상: 산타

## MVC 패턴 역할
### Controller
- **ChristmasController**
  - Model과 View의 중개 역할로 설계한다. 
  - UI와 도메인 로직과 분리를 명확히 하는 Layer Architecture로 간주한다.
### Model
#### Domain
- **Menu**
  - Menu는 메뉴 이름, 가격, 수량, 카테고리에 대한 정보를 가지고 있는 도메인으로 추상클래스이다.
  - 4개의 카테고리로 나누어 자식클래스를 구현한다.
    - Appetizer
    - Drink
    - Dessert
    - Main
- **EventMenu**
  - Menu 객체의 리스트(*Menus*)를 멤버 변수로 가지고 있는 일급 컬렉션으로 래핑한다.
  - 주문한 *Menus* 관련된 비즈니스 로직의 책임을 가진다.
    - 메뉴판의 *Menus*를 초기화 한다.
    - *Menus*에서 이름으로 검색한 메뉴를 조회한다.
- **EventManager**
  - 고객이 주문한 메뉴 리스트를 관리한다.
  - 주문한 메뉴 리스트의 총금액, 할인금액 등을 관리한다.
  - 증정 이벤트, 할인 이벤트 등 이벤트에 충족되는 총주문금액인지 여부 판별
  - 할인 혜택별 조건 여부
    - 증정 이벤트 조건을 충족하는가?
    - 혜택 내역 조건을 충족하는가?
    - 뱃지 부여 조건을 충족하는가?
- **EventCalendar**
  - EventCalendar는 `12월 이벤트 계획` 날짜 관리를 위한 도메인이다.
  - 2023년 12월 1일 ~ 2023년 12월 31일로 날짜 범위를 정한다.
  - 방문 날짜가 *크리스마스 디데이 할인* 에 해당되는지 검증
    - 디데이 할인: 2023.12.1 ~ 2023.12.25
  - 방문 날짜가 *평일 할인* 에 해당되는지 검증
    - 평일(weekday): 할인(일요일 ~ 목요일)
  - 방문 날짜가 *주말 할인* 에 해당되는지 검증
    - 주말(weekend): 할인(금요일, 토요일)
  - 방문 날짜가 *특별 할인* 에 해당되는지 검증
    - 특별 할인: 이벤트 달력에 별이 있다. (*3, 10, 17, 24, 31, 25*)
- **DiscountPolicy(Interface)**
  - 새로운 할인 정책이 추가되거나 기존의 할인 정책이 변경되어도 주어진 할인 정책을 적용할 수 있다. 
  - 크리스마스 디데이, 주말, 평일, 특별 할인, 증정 메뉴 정책 구현체를 생성한다.
- **DiscountCondition(Interface)**
  - 새로운 할인 조건이 추가되거나 기존의 할인 조건이 변경되어도 주어진 할인 조건을 적용할 수 있다. 
  - 크리스마스 디데이, 주말, 평일, 특별 할인 조건 구현체를 생성한다.
#### Enum
- **Category**
  - Enum Type 카테고리를 Appetizer, Drink, Dessert, Main으로 분리한다.
- **Price**
  - Enum Type 가격을 메뉴판을 통해 메뉴 금액을 선언한다.
- **EventBadge**
  - Enum Type 이벤트 뱃지 종류를 가지고 있다.
  - 혜택 금액별 이벤트 뱃지를 부여하는 메서드를 구현한다.
#### Service
- 단일 책임 원칙(Single Responsibility Principle)을 지향한다.
- **MenuService**
  - `메뉴표`에 명시된 메뉴 이름 및 가격을 이벤트 진행 전에 초기화한다.
  - 고객이 주문한 메뉴를 주문 내역에 등록한다.
  - 고객에게 주문받은 메뉴를 EventManager에게 메뉴 및 금액 정보를 전달한다.
- **EventManagerService**
  - 이벤트 할인 정책 및 조건
    - 크리스마스 데일리 할인 정책 및 조건을 적용한다.
    - 평일 할인 정책 및 조건을 적용한다.
    - 주말 할인 정책 및 조건을 적용한다.
    - 특별 할인 정책 및 조건을 적용한다.
    - 증정 이벤트 정책을 적용한다.
#### Factory
- 개방-폐쇄 원칙(Open-Closed Principle)을 지향한다.
- **MenuFactory**
  - 메뉴 객체를 생성하는 역할을 담당한다.
  - 메뉴 카테고리, 가격, 이름 및 다른 종류의 메뉴 항목 추가 등 정보 변경을 담당한다.
### View
- **InputView**
  - 사용자의 입력 로직을 처리한다.
    - 방문 날짜를 입력받는다.
    - 주문 메뉴를 입력받는다.
- **OutputView**
  - Controller의 출력 로직을 처리한다.
    - 계산된 할인 전 총주문 금액을 출력한다.
    - 증정 메뉴 적용여부에 따른 메뉴를 출력한다.
    - 혜택 내역 적용여부에 따른 혜택 내역을 출력한다.
    - 총혜택 금액 산정에 따른 금액을 출력한다.
    - 할인 후 예상 결제 금액 산정에 따른 금액을 출력한다.
    - 혜택 금액에 따른 12월 이벤트 배지 종류를 출력한다.
### Util
- **Constant**
- 상수(constant)는 변하지 않는 값으로 실행될 때 변경되지 않는 값을 기준으로 한다.
  - NumberConstant
    - 날짜 관련 정수형을 상수 처리
- **validate**
- InputValidate
  - 사용자 입력 값에 대한 예외 처리 로직을 구현한다.
- Enum Type으로 카테고리와 입력 에러 메시지를 안전하게 관리한다.
  - DateError
    - 방문 날짜 입력 에러메세지를 출력한다.
  - MenuError
    - 주문 메뉴 입력 에러메세지를 출력한다.
## 📌 예외처리 목록

- 예외는 Exception이 아닌 IllegalArgumentException, IllegalStateException 등과 같은 명확한 유형을 처리한다.
- 사용자가 잘못된 값을 입력할 경우 IllegalArgumentException를 발생시키고, `[ERROR]`로 시작하는 에러 메시지를 출력 후 그 부분부터 입력을 다시 받는다.
    - **예외발생 시 Application가 종료되어선 안 된다.**
    - 예외처리 기능 목록은 `[O]`로 double-check한다.

### View
- **InputValidate**
    - 사용자의 입력 로직을 예외 처리한다.
    - 방문 날짜 입력
      - 입력 값은 정수형으로 입력받는다. [O]
      - 방문할 날짜는 1 이상 31 이하의 숫자로만 입력받는다. [O]
    - 주문 메뉴 입력
      - 고객이 메뉴판에 없는 메뉴를 입력하는 경우 [O]
      - 메뉴의 개수는 1 이상의 숫자만 입력받는다. [O]
      - 메뉴 형식이 예시와 다른 경우 예외를 발생한다. [O]
        - 단일메뉴 시, `1번메뉴이름-1번메뉴갯수`
        - 복수메뉴 시, `1번메뉴이름-1번메뉴갯수,2번메뉴이름-2번메뉴갯수`
      - 중복 메뉴를 입력한 경우 예외를 발생한다. [O]
      - 음료만 주문 시, 주문할 수 없으므로 예외를 발생한다. [O]
      - 메뉴는 한 번에 최대 20개까지만 주문할 수 있다. [O]
        - 메뉴 이름 개수가 아닌, 메뉴 수량이 총합 20개를 넘어서는 안 된다.
        - 메뉴 이름 개수가 최대 20개 까지인 것도 위의 논리에 성립된다.
## 📌 테스트 검증

#### 도메인 로직
- Event
  - EventManagerTest  
    - 주문한 메뉴리스트의 총 주문 금액을 계산한다.
    - 총 혜택금액을 계산한다.
    - 할인 후 예상 결제금액을 계산한다.
    - 혜택금액에 따른 이벤트 뱃지를 지급한다.
  - EventBadgeTest  
    - 최소 혜택 금액별 뱃지를 부여한다.
  - EventCalendarTest  
    - 입력 날짜의 크리스마스 디데이 할인 여부를 테스트한다.
    - 입력 날짜의 평일 할인 여부를 테스트한다.
    - 입력 날짜의 주말 할인 여부를 테스트한다.
    - 입력 날짜의 특별 할인 여부를 테스트한다.
  - EventCalendarTest  
    - 메뉴들을 메뉴판에 정상적으로 초기화한다.
    - 메뉴 이름을 통해 카테고리를 검색한다.
- Discount
  - DiscountTest
    - 입력 날짜의 크리스마스 디데이 할인 정책 및 조건이 적용된다.
    - 입력 날짜의 평일 할인 정책 및 조건이 적용된다.
    - 입력 날짜의 주말 할인 정책 및 조건이 적용된다.
    - 입력 날짜의 특별 할인 정책 및 조건이 적용된다. 
    - 증정 메뉴 정책이 적용된다.
- Service
  - EventManagerService
    - 이벤트 할인 정책이 10,000원 이상일 경우 정상적으로 혜택 금액에 적용된다.
    - 이벤트 할인 정책이 10,000원 미만일 경우 적용되지 않는다.
  - MenuService
    - 12월 이벤트 메뉴에 포함된 모든 메뉴를 초기화한다.
    - 주문이 정상적으로 됐는지 주문 메뉴 목록을 검증한다.

#### 예외 발생
- 사용자의 입력 로직을 예외 처리한다.
  - 방문 날짜 입력
    - 입력 값은 정수형으로 입력받는다.
    - 방문할 날짜는 1 이상 31 이하의 숫자로만 입력받는다.
  - 메뉴 입력
    - 고객이 메뉴판에 없는 메뉴를 입력하는 경우
    - 메뉴의 개수는 1 이상의 숫자만 입력받는다.
    - 메뉴 형식이 예시와 다른 경우 예외를 발생한다.
      - 단일메뉴 시, `1번메뉴이름-1번메뉴갯수`
      - 복수메뉴 시, `1번메뉴이름-1번메뉴갯수,2번메뉴이름-2번메뉴갯수`
    - 중복 메뉴를 입력한 경우 예외를 발생한다.
    - 음료만 주문 시, 주문할 수 없으므로 예외를 발생한다.
    - 메뉴는 한 번에 최대 20개까지만 주문할 수 있다.
